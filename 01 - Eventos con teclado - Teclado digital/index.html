<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>JS Drum Kit con Grabadora</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="https://fav.farm/üî•" />
  <style>
    .key {
      border: .4rem solid black;
      border-radius: .5rem;
      margin: 1rem;
      font-size: 1.5rem;
      padding: 1rem .5rem;
      transition: all .07s ease;
      width: 100px;
      text-align: center;
      display: inline-block;
      background: #eee;
      cursor: pointer;
    }
    .playing {
      transform: scale(1.1);
      border-color: #ffc600;
      box-shadow: 0 0 10px #ffc600;
    }
    .controls {
      margin: 20px;
    }
    button {
      margin: 5px;
      padding: 10px 15px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <div class="keys">
    <div data-key="65" class="key"><kbd>A</kbd><span class="sound">clap</span></div>
    <div data-key="83" class="key"><kbd>S</kbd><span class="sound">hihat</span></div>
    <div data-key="68" class="key"><kbd>D</kbd><span class="sound">kick</span></div>
    <div data-key="70" class="key"><kbd>F</kbd><span class="sound">openhat</span></div>
    <div data-key="71" class="key"><kbd>G</kbd><span class="sound">boom</span></div>
    <div data-key="72" class="key"><kbd>H</kbd><span class="sound">ride</span></div>
    <div data-key="74" class="key"><kbd>J</kbd><span class="sound">snare</span></div>
    <div data-key="75" class="key"><kbd>K</kbd><span class="sound">tom</span></div>
    <div data-key="76" class="key"><kbd>L</kbd><span class="sound">tink</span></div>
  </div>

  <!-- Sonidos -->
  <audio data-key="65" src="sonidos/clap.wav"></audio>
  <audio data-key="83" src="sonidos/hihat.wav"></audio>
  <audio data-key="68" src="sonidos/kick.wav"></audio>
  <audio data-key="70" src="sonidos/openhat.wav"></audio>
  <audio data-key="71" src="sonidos/boom.wav"></audio>
  <audio data-key="72" src="sonidos/ride.wav"></audio>
  <audio data-key="74" src="sonidos/snare.wav"></audio>
  <audio data-key="75" src="sonidos/tom.wav"></audio>
  <audio data-key="76" src="sonidos/tink.wav"></audio>

  <!-- Botones de control -->
  <div class="controls">
    <button id="startRec">üéôÔ∏è Grabar</button>
    <button id="stopRec">‚èπÔ∏è Detener</button>
    <button id="playRec">‚ñ∂Ô∏è Reproducir</button>
  </div>

<script>
  let recording = false;
  let recordStartTime;
  let recordedNotes = [];

  function playSound(e, isReplay=false) {
    const keyCode = e.keyCode || e; // si es tecla o si se pasa el c√≥digo directamente
    const audio = document.querySelector(`audio[data-key="${keyCode}"]`);
    const key = document.querySelector(`.key[data-key="${keyCode}"]`);
    if (!audio) return;
    audio.currentTime = 0;
    audio.play();
    key.classList.add("playing");

    if (recording && !isReplay) {
      recordedNotes.push({
        key: keyCode,
        time: Date.now() - recordStartTime
      });
    }
  }

  function removeTransition(e) {
    if (e.propertyName !== "transform") return;
    this.classList.remove("playing");
  }

  const keys = document.querySelectorAll(".key");
  keys.forEach(key => key.addEventListener("transitionend", removeTransition));
  window.addEventListener("keydown", playSound);

  // Botones
  document.getElementById("startRec").addEventListener("click", () => {
    recording = true;
    recordedNotes = [];
    recordStartTime = Date.now();
    console.log("Grabaci√≥n iniciada...");
  });

  document.getElementById("stopRec").addEventListener("click", () => {
    recording = false;
    console.log("Grabaci√≥n detenida:", recordedNotes);
  });

  document.getElementById("playRec").addEventListener("click", () => {
    if (recordedNotes.length === 0) return;
    console.log("Reproduciendo...");
    recordedNotes.forEach(note => {
      setTimeout(() => playSound(note.key, true), note.time);
    });
  });
</script>

</body>
</html>

